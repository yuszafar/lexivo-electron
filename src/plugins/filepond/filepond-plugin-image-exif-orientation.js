!function(A,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(A=A||self,A.FilePondPluginImageExifOrientation=n())}(this,function(){"use strict";var A=function(A){return/^image\/jpeg/.test(A.type)},n={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280},e=function(A,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint16(n,e)},t=function(A,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint32(n,e)},i=function(A){return new Promise(function(i,o){var r=new FileReader;r.onload=function(A){var o=new DataView(A.target.result);if(e(o,0)===n.JPEG){for(var r=o.byteLength,a=2;a<r;){var u=e(o,a);if(a+=2,u===n.APP1){if(t(o,a+=2)!==n.EXIF)break;var f=e(o,a+=6)===n.TIFF;a+=t(o,a+4,f);var d=e(o,a,f);a+=2;for(var l=0;l<d;l++)if(e(o,a+12*l,f)===n.Orientation)return void i(e(o,a+12*l+8,f))}else{if((u&n.Unknown)!==n.Unknown)break;a+=e(o,a)}}i(-1)}else i(-1)},r.readAsArrayBuffer(A.slice(0,65536))})},o=void 0,r="undefined"!=typeof window&&void 0!==window.document?new Image:{};r.onload=function(){return o=r.naturalWidth>r.naturalHeight},r.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";var a=function(){return o},u=function(n){var e=n.addFilter,t=n.utils,o=t.Type,r=t.isFile;return e("DID_LOAD_ITEM",function(n,e){var t=e.query;return new Promise(function(e,o){var u=n.file;if(!(r(u)&&A(u)&&t("GET_ALLOW_IMAGE_EXIF_ORIENTATION")&&a()))return e(n);i(u).then(function(A){n.setMetadata("exif",{orientation:A}),e(n)})})}),{options:{allowImageExifOrientation:[!0,o.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:u})),u})